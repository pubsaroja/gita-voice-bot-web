<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bhagavad Gita Bot</title>
  <style>
    body {
      font-family: 'Outfit', sans-serif;
      text-align: center;
      margin: 20px;
      background-color: #FFFFFF;
    }

    h1 { color: #2c3e50; font-size: 1.5em; }
    p { margin-bottom: 15px; }

    /* ==== BUTTONS ==== */
    button {
      min-width: 100px;
      padding: 12px;
      font-size: 1.1em;
      border: none;
      border-radius: 8px;
      background-color: #357EC7;
      color: white;
      cursor: pointer;
      transition: background 0.3s ease;
      flex: none;   /* prevents stretching beyond borders */
    }
    button:hover { background-color: #1e40af; }

    /* ==== FLEX CONTAINERS ==== */
    .top-buttons,
    .player-container {
      display: flex;
      justify-content: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    /* ==== BUTTON GROUP WRAPPER ==== */
    .button-group {
      border: 2px solid #357EC7;
      border-radius: 8px;
      padding: 10px;
      margin: 10px auto;
      width: 100%;
      max-width: 600px;
      box-sizing: border-box;
    }

    /* ==== SHLOKA TEXT ==== */
    .shloka-text {
      margin-top: 10px;
      font-size: 1.5em;
      color: #333;
      white-space: pre-wrap;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      line-height: 1.5;
      min-height: 3em;
      padding: 10px;
      border: 2px solid #357EC7;
      border-radius: 5px;
      display: none;
      justify-content: center;
      text-align: center;
      font-family: 'Ramabhadra', sans-serif;
    }
    .shloka-text.active { display: flex; }

    .textbox-label {
      font-weight: bold;
      margin-top: 15px;
      margin-bottom: 5px;
      font-size: 1.2em;
      color: #357EC7;
      display: none;
    }
    .textbox-label.active { display: block; }

    /* ==== DROPDOWN GROUP ==== */
    .dropdown-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      max-width: 600px;
      border: 2px solid #357EC7;
      border-radius: 5px;
      padding: 10px;
      margin: 10px auto;
      box-sizing: border-box;
    }
    .dropdown-container select {
      padding: 10px;
      font-size: 1em;
      border-radius: 5px;
      max-width: 150px;
    }

    /* ==== MODAL ==== */
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .modal-content {
      background-color: #fff;
      padding: 20px;
      border-radius: 5px;
      max-width: 90%;
      max-height: 80%;
      overflow-y: auto;
      border: 2px solid #357EC7;
    }
    .close-button {
      background: #ff4444;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 25px;
      cursor: pointer;
      float: right;
    }

    /* ==== VERSE GRID ==== */
    .verse-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
      gap: 10px;
      margin-top: 20px;
    }
    .verse-button {
      border: 1px solid #357EC7;
      border-radius: 5px;
      padding: 10px;
      cursor: pointer;
      font-size: 0.9em;
    }
    .verse-button:hover { background: #e0e0e0; }

    /* ==== MOBILE ==== */
    @media (max-width: 600px) {
      .top-buttons,
      .player-container { gap: 5px; }
      button { font-size: 1em; padding: 10px; }
    }
  </style>
</head>
<body>
  <h1>Bhagavad Gita Bot</h1>
  <p style="color: black;">Listen, understand and memorize Bhagavad Gita shlokas</p>

  <!-- Top Buttons -->
  <div class="button-group">
    <div class="top-buttons">
      <button onclick="sendCommand('SGSFirstPaada')">SGS<br>(1st Paada)</button>
      <button onclick="sendCommand('SringeriPaada')">Sringeri<br>(1st or 3rd Paada)</button>
    </div>
  </div>

  <!-- Shloka Style Radio -->
  <div class="radio-group">
    <label>Shloka Style:</label>
    <input type="radio" name="style" value="sgs" id="sgs" onchange="updateTextboxVisibility()">
    <label for="sgs">SGS</label>
    <input type="radio" name="style" value="sringeri" id="sringeri" checked onchange="updateTextboxVisibility()">
    <label for="sringeri">Sringeri</label>
  </div>

  <!-- Player Controls 1 -->
  <div class="button-group">
    <div class="player-container">
      <button onclick="sendCommand('PreviousShloka')">Previous</button>
      <button onclick="sendCommand('FullShloka')">Full Shloka</button>
      <button onclick="sendCommand('NextFullShloka')">Next</button>
    </div>
  </div>

  <!-- Shloka Texts -->
  <div>
    <div id="sgsLabel" class="textbox-label">SGS Style Shloka</div>
    <div id="sgsText" class="shloka-text">Your Shloka will appear here.</div>
    <div id="sringeriLabel" class="textbox-label">Sringeri Style Shloka</div>
    <div id="sringeriText" class="shloka-text">Your Shloka will appear here.</div>
  </div>

  <!-- Player Controls 2 -->
  <div class="button-group">
    <div class="player-container">
      <button onclick="handleMeanings()">Meanings</button>
      <button onclick="showVerseTable()">Select Shloka</button>
      <button onclick="toggleInstructions()">Instructions</button>
    </div>
  </div>

  <!-- Dropdowns -->
  <div class="dropdown-container">
    <label for="chapterSelect">Random Shloka from Chapter:</label>
    <select id="chapterSelect" onchange="handleChapterSelect(this)">
      <option disabled selected>-- Select Chapter --</option>
      <option value="1">1. అర్జునవిషాదయోగః</option>
      <option value="2">2. సాఙ్ఖ్యయోగః</option>
      <!-- ... rest ... -->
    </select>
    <label for="continuousPlaySelect">Continuous Play:</label>
    <select id="continuousPlaySelect" onchange="handleContinuousPlay(this)">
      <option disabled selected>-- Select Chapter --</option>
      <option value="1">1. అర్జునవిషాదయోగః</option>
      <option value="2">2. సాఙ్ఖ్యయోగః</option>
      <!-- ... rest ... -->
    </select>
  </div>

  <!-- Modal -->
  <div id="verseTableModal" class="modal">
    <div class="modal-content">
      <button class="close-button" onclick="closeVerseTable()">Close</button>
      <select id="chapterTableSelect" onchange="updateVerseGrid()">
        <option disabled selected>-- Select Chapter --</option>
        <option value="1">Chapter 1 (47 verses)</option>
        <option value="2">Chapter 2 (72 verses)</option>
        <!-- ... rest ... -->
      </select>
      <div id="verseTableContent" class="verse-grid"></div>
    </div>
  </div>

  <script>
    // fix labels
    function updateTextboxVisibility() {
      const style = document.querySelector('input[name="style"]:checked').value;
      document.getElementById('sgsLabel').classList.toggle('active', style === 'sgs');
      document.getElementById('sgsText').classList.toggle('active', style === 'sgs');
      document.getElementById('sringeriLabel').classList.toggle('active', style === 'sringeri');
      document.getElementById('sringeriText').classList.toggle('active', style === 'sringeri');
    }
    window.addEventListener('DOMContentLoaded', updateTextboxVisibility);

    // modal functions
    function showVerseTable() {
      document.getElementById('verseTableModal').style.display = 'flex';
    }
    function closeVerseTable() {
      document.getElementById('verseTableModal').style.display = 'none';
    }
    function updateVerseGrid() {
      const chapter = document.getElementById('chapterTableSelect').value;
      const verseGrid = document.getElementById('verseTableContent');
      verseGrid.innerHTML = '';
      if (!chapter) return;
      let totalVerses = {1:47,2:72,3:43,4:42,5:29,6:47,7:30,8:28,9:34,10:42,11:55,12:20,13:34,14:27,15:20,16:24,17:28,18:78}[chapter];
      for (let i=1; i<=totalVerses; i++) {
        const btn = document.createElement('button');
        btn.className = 'verse-button';
        btn.textContent = i;
        btn.onclick = () => sendCommand(`PlayShloka:${chapter}:${i}`);
        verseGrid.appendChild(btn);
      }
    }
  </script>
</body>
</html>
