<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bhagavad Gita Bot</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
            background-color: #f0f0f0;
        }
        h1 {
            color: #2c3e50;
            font-size: 1.5em;
        }
        h2 {
            color: #34495e;
            font-size: 1em;
            margin-top: 10px;
        }
        .button-container {
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            justify-content: center;
            gap: 5px;
        }
        button {
            background-color: #357EC7;
            color: white;
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
        }
        button:hover {
            background-color: #008CBA;
        }
        select {
            padding: 10px;
            margin: 5px;
            font-size: 1em;
            border-radius: 5px;
        }
        .shloka-text {
            margin-top: 10px;
            font-size: 1.2em;
            color: #333;
            white-space: pre-wrap;
            text-align: left;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.5;
            height: 7.2em;
            overflow-y: auto;
            padding: 10px;
            border: 2px solid #357EC7;
            border-radius: 5px;
        }
        #audioPlayer {
            margin-top: 20px;
        }
        .radio-group {
            margin: 10px 0;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }
        .radio-group label {
            margin: 0 10px;
        }
        .textbox-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        .textbox-container > div {
            width: 100%;
            max-width: 600px;
        }
        .textbox-label {
            font-weight: bold;
            margin-bottom: 5px;
            display: none;
        }
        .textbox-label.active {
            display: block;
        }
        .shloka-text {
            display: none;
        }
        .shloka-text.active {
            display: block;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 5px;
            max-width: 80%;
            max-height: 80%;
            overflow-y: auto;
            border: 2px solid #357EC7;
        }
        .chapter-select {
            margin-bottom: 10px;
            padding: 10px;
            font-size: 1em;
            border-radius: 5px;
            width: 100%;
            max-width: 200px;
        }
        .verse-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
            gap: 10px;
            padding: 10px;
        }
        .verse-button {
            background-color: #f9f9f9;
            border: 1px solid #357EC7;
            border-radius: 5px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            font-size: 0.9em;
        }
        .verse-button:hover {
            background-color: #e0e0e0;
        }
        .close-button {
            background-color: #ff4444;
            color: white;
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            float: right;
        }
        .close-button:hover {
            background-color: #cc0000;
        }
        @media (max-width: 600px) {
            .button-container {
                flex-direction: column;
            }
            button {
                width: 100%;
                max-width: 300px;
                margin: 5px auto;
            }
            .verse-grid {
                grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
            }
        }
    </style>
</head>
<body>
    <h1>Bhagavad Gita Bot</h1>
    
    <div class="button-container">
        <button onclick="sendCommand('ZeroIntent', {quarter: 'pada1', style: getSelectedStyle()})">Get Random Shloka Q1</button>
        <button onclick="sendCommand('ZeroIntent', {quarter: 'pada1_or_pada3', style: getSelectedStyle()})">Get Random Shloka Q1 or Q3</button>
        <button onclick="sendCommand('FullIntent', {style: getSelectedStyle()})">Get Full Shloka</button>
        <button onclick="sendCommand('NextIntent', {style: getSelectedStyle(), pada: 'pada1'})">Next Shloka</button>
        <button id="previousButton" onclick="handlePreviousShloka()">Previous Shloka</button>
        <button onclick="handleMeanings()">Meanings</button>
        <button onclick="showVerseTable()">Regular Readers</button>
    </div>
    
    <div>
        <select id="chapterSelect" onchange="handleChapterSelect(this)">
            <option value="" selected disabled>-- Select Chapter --</option>
            <option value="1">Chapter 1</option>
            <option value="2">Chapter 2</option>
            <option value="3">Chapter 3</option>
            <option value="4">Chapter 4</option>
            <option value="5">Chapter 5</option>
            <option value="6">Chapter 6</option>
            <option value="7">Chapter 7</option>
            <option value="8">Chapter 8</option>
            <option value="9">Chapter 9</option>
            <option value="10">Chapter 10</option>
            <option value="11">Chapter 11</option>
            <option value="12">Chapter 12</option>
            <option value="13">Chapter 13</option>
            <option value="14">Chapter 14</option>
            <option value="15">Chapter 15</option>
            <option value="16">Chapter 16</option>
            <option value="17">Chapter 17</option>
            <option value="18">Chapter 18</option>
        </select>
    </div>
    
    <div class="radio-group">
        <label>Full Shloka Style:</label>
        <input type="radio" name="style" value="gurudatta" id="gurudatta" checked onchange="updateTextboxVisibility()">
        <label for="gurudatta">Gurudatta Style</label>
        <input type="radio" name="style" value="sringeri" id="sringeri" onchange="updateTextboxVisibility()">
        <label for="sringeri">Sringeri Style</label>
    </div>
    
    <div class="textbox-container">
        <div>
            <div id="gurudattaLabel" class="textbox-label active">Gurudatta Style Shloka</div>
            <div id="gurudattaText" class="shloka-text active">Your Shloka will appear here</div>
        </div>
        <div>
            <div id="sringeriLabel" class="textbox-label">Sringeri Style Shloka</div>
            <div id="sringeriText" class="shloka-text">Your Shloka will appear here</div>
        </div>
    </div>
    
    <audio id="audioPlayer" controls></audio>
    
    <div id="verseTableModal" class="modal">
        <div class="modal-content">
            <button class="close-button" onclick="closeVerseTable()">Close</button>
            <select id="chapterTableSelect" class="chapter-select" onchange="updateVerseGrid()">
                <option value="" selected disabled>-- Select Chapter --</option>
                <option value="1">Chapter 1 (47 verses)</option>
                <option value="2">Chapter 2 (72 verses)</option>
                <option value="3">Chapter 3 (43 verses)</option>
                <option value="4">Chapter 4 (42 verses)</option>
                <option value="5">Chapter 5 (29 verses)</option>
                <option value="6">Chapter 6 (47 verses)</option>
                <option value="7">Chapter 7 (30 verses)</option>
                <option value="8">Chapter 8 (28 verses)</option>
                <option value="9">Chapter 9 (34 verses)</option>
                <option value="10">Chapter 10 (42 verses)</option>
                <option value="11">Chapter 11 (55 verses)</option>
                <option value="12">Chapter 12 (20 verses)</option>
                <option value="13">Chapter 13 (34 verses)</option>
                <option value="14">Chapter 14 (27 verses)</option>
                <option value="15">Chapter 15 (20 verses)</option>
                <option value="16">Chapter 16 (24 verses)</option>
                <option value="17">Chapter 17 (28 verses)</option>
                <option value="18">Chapter 18 (78 verses)</option>
            </select>
            <div id="verseTableContent" class="verse-grid"></div>
        </div>
    </div>
    
    <script>
        const verseCounts = {
            1: 47, 2: 72, 3: 43, 4: 42, 5: 29, 6: 47, 7: 30, 8: 28,
            9: 34, 10: 42, 11: 55, 12: 20, 13: 34, 14: 27, 15: 20,
            16: 24, 17: 28, 18: 78
        };

        async function fetchAudioUrl(chapter, verse, quarter = null) {
            const baseUrl = 'https://raw.githubusercontent.com/pubsaroja/bhagavad-gita-bot/refs/heads/main';
            const key = `${chapter}.${verse}`;
            console.log(`Fetching audio URL for ${key}, quarter: ${quarter}`);
            let audioUrl;
            
            if (quarter === 'pada1') {
                audioUrl = `${baseUrl}/AudioPada1/${chapter}.${verse}.mp3`;
            } else if (quarter === 'pada1_or_pada3') {
                audioUrl = `${baseUrl}/AudioPada1/${chapter}.${verse}.mp3`; // Try Pada1 first
            } else {
                audioUrl = `${baseUrl}/AudioFull/${chapter}.${verse}.mp3`;
            }

            try {
                // Validate primary URL
                const audioCheck = await fetch(audioUrl, { method: 'HEAD', mode: 'cors' });
                if (!audioCheck.ok && quarter === 'pada1_or_pada3') {
                    console.warn(`Primary URL inaccessible: ${audioUrl}, trying AudioPada3`);
                    audioUrl = `${baseUrl}/AudioPada3/${chapter}.${verse}.mp3`;
                    const pada3Check = await fetch(audioUrl, { method: 'HEAD', mode: 'cors' });
                    if (!pada3Check.ok) {
                        console.warn(`AudioPada3 inaccessible: ${audioUrl}, falling back to AudioFull`);
                        audioUrl = `${baseUrl}/AudioFull/${chapter}.${verse}.mp3`;
                        const fullCheck = await fetch(audioUrl, { method: 'HEAD', mode: 'cors' });
                        if (!fullCheck.ok) {
                            throw new Error(`All audio URLs inaccessible for ${key}`);
                        }
                    }
                } else if (!audioCheck.ok) {
                    console.warn(`Primary URL inaccessible: ${audioUrl}, falling back to AudioFull`);
                    audioUrl = `${baseUrl}/AudioFull/${chapter}.${verse}.mp3`;
                    const fullCheck = await fetch(audioUrl, { method: 'HEAD', mode: 'cors' });
                    if (!fullCheck.ok) {
                        throw new Error(`All audio URLs inaccessible for ${key}`);
                    }
                }
                console.log(`Audio URL for ${key}: ${audioUrl}`);
                return audioUrl;
            } catch (error) {
                console.error(`Error fetching audio URL for ${key}: ${error}`);
                return `${baseUrl}/AudioFull/${chapter}.${verse}.mp3`; // Final fallback
            }
        }

        async function fetchShlokaMeaning(chapter, verse) {
            const url = 'https://raw.githubusercontent.com/pubsaroja/bhagavad-gita-bot/refs/heads/main/meanings.txt';
            console.log(`Fetching meaning for chapter ${chapter}, verse ${verse} from ${url}`);
            try {
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`HTTP error: ${response.status}`);
                }
                const data = await response.json();
                const keys = Object.keys(data);
                console.log(`Meaning JSON fetched, available keys: ${keys.join(', ')}`);
                
                const key = `${chapter}.${verse}`;
                if (data[key] && data[key].అర్థము) {
                    console.log(`Found meaning for ${key}: ${data[key].అర్థము}`);
                    return `${chapter}.${verse} Meaning:\n${data[key].అర్థము}`;
                } else {
                    console.log(`No meaning found for ${key}`);
                    return `Meaning for ${chapter}.${verse} not found`;
                }
            } catch (error) {
                console.error(`Error fetching meaning: ${error}`);
                return `Error loading meaning for ${chapter}.${verse}`;
            }
        }

        function showVerseTable() {
            const modal = document.getElementById('verseTableModal');
            const chapterSelect = document.getElementById('chapterTableSelect');
            chapterSelect.value = '';
            updateVerseGrid();
            modal.style.display = 'flex';
        }

        function updateVerseGrid() {
            const chapter = parseInt(document.getElementById('chapterTableSelect').value);
            const content = document.getElementById('verseTableContent');
            content.innerHTML = '';

            if (chapter) {
                const verseGrid = document.createElement('div');
                verseGrid.className = 'verse-grid';
                for (let verse = 1; verse <= verseCounts[chapter]; verse++) {
                    const verseButton = document.createElement('div');
                    verseButton.className = 'verse-button';
                    verseButton.textContent = `${chapter}.${verse}`;
                    verseButton.onclick = () => selectVerse(chapter, verse);
                    verseGrid.appendChild(verseButton);
                }
                content.appendChild(verseGrid);
            }
        }

        function closeVerseTable() {
            document.getElementById('verseTableModal').style.display = 'none';
        }

        async function selectVerse(chapter, verse) {
            const style = getSelectedStyle();
            console.log(`Selecting verse: ${chapter}.${verse}, style: ${style}`);
            currentContext = currentContext.filter(ctx => !ctx.name.includes('shloka-context'));
            currentContext.push({
                name: `projects/gita-voice-bot/agent/sessions/${sessionId}/contexts/shloka-context`,
                lifespanCount: 5,
                parameters: { chapter: parseInt(chapter), verse: parseInt(verse), style: style }
            });
            localStorage.setItem('gitaContext', JSON.stringify(currentContext));
            
            const shlokaText = await fetchShlokaText(chapter, verse, style);
            document.getElementById('gurudattaText').innerText = shlokaText;
            document.getElementById('sringeriText').innerText = shlokaText;
            
            const audioUrl = await fetchAudioUrl(chapter, verse);
            const audioPlayer = document.getElementById('audioPlayer');
            audioPlayer.src = audioUrl;
            try {
                await audioPlayer.play();
                console.log(`Playing audio: ${audioUrl}`);
            } catch (error) {
                console.error(`Error playing audio for ${chapter}.${verse}: ${error}`);
                document.getElementById('gurudattaText').innerText = `Error playing audio for ${chapter}.${verse}`;
                document.getElementById('sringeriText').innerText = `Error playing audio for ${chapter}.${verse}`;
            }
            
            updateTextboxVisibility();
            closeVerseTable();
        }

        async function handlePreviousShloka() {
            const context = currentContext.find(ctx => ctx.name.includes('shloka-context'));
            if (context && context.parameters && Number.isInteger(context.parameters.chapter) && Number.isInteger(context.parameters.verse)) {
                let chapter = Math.floor(context.parameters.chapter);
                let verse = Math.floor(context.parameters.verse);
                console.log(`Current context: chapter ${chapter}, verse ${verse}`);
                verse -= 1;
                if (verse < 1) {
                    chapter -= 1;
                    if (chapter < 1) {
                        chapter = 1;
                        verse = 1;
                    } else {
                        verse = verseCounts[chapter];
                    }
                }
                console.log(`Previous shloka: chapter ${chapter}, verse ${verse}`);
                const style = getSelectedStyle();
                currentContext = currentContext.filter(ctx => !ctx.name.includes('shloka-context'));
                currentContext.push({
                    name: `projects/gita-voice-bot/agent/sessions/${sessionId}/contexts/shloka-context`,
                    lifespanCount: 5,
                    parameters: { chapter: parseInt(chapter), verse: parseInt(verse), style: style }
                });
                localStorage.setItem('gitaContext', JSON.stringify(currentContext));
                
                const shlokaText = await fetchShlokaText(chapter, verse, style);
                document.getElementById('gurudattaText').innerText = shlokaText;
                document.getElementById('sringeriText').innerText = shlokaText;
                
                const audioUrl = await fetchAudioUrl(chapter, verse);
                const audioPlayer = document.getElementById('audioPlayer');
                audioPlayer.src = audioUrl;
                try {
                    await audioPlayer.play();
                    console.log(`Playing audio: ${audioUrl}`);
                } catch (error) {
                    console.error(`Error playing audio for ${chapter}.${verse}: ${error}`);
                    document.getElementById('gurudattaText').innerText = `Error playing audio for ${chapter}.${verse}`;
                    document.getElementById('sringeriText').innerText = `Error playing audio for ${chapter}.${verse}`;
                }
                
                updateTextboxVisibility();
            } else {
                console.log('No valid context for Previous Shloka');
                const errorText = 'Please select a Shloka first';
                document.getElementById('gurudattaText').innerText = errorText;
                document.getElementById('sringeriText').innerText = errorText;
                updateTextboxVisibility();
            }
        }

        async function handleMeanings() {
            const context = currentContext.find(ctx => ctx.name.includes('shloka-context'));
            if (context && context.parameters && Number.isInteger(context.parameters.chapter) && Number.isInteger(context.parameters.verse)) {
                const chapter = Math.floor(context.parameters.chapter);
                const verse = Math.floor(context.parameters.verse);
                console.log(`Fetching meaning for chapter ${chapter}, verse ${verse}`);
                
                const meaningText = await fetchShlokaMeaning(chapter, verse);
                document.getElementById('gurudattaText').innerText = meaningText;
                document.getElementById('sringeriText').innerText = meaningText;
                
                updateTextboxVisibility();
            } else {
                console.log('No valid context for Meanings');
                const errorText = 'Please select a Shloka first';
                document.getElementById('gurudattaText').innerText = errorText;
                document.getElementById('sringeriText').innerText = errorText;
                updateTextboxVisibility();
            }
        }

        async function handleChapterSelect(selectElement) {
            const chapter = parseInt(selectElement.value);
            if (chapter) {
                const style = getSelectedStyle();
                console.log(`Chapter selected: ${chapter}, style: ${style}`);
                currentContext = currentContext.filter(ctx => !ctx.name.includes('shloka-context'));
                currentContext.push({
                    name: `projects/gita-voice-bot/agent/sessions/${sessionId}/contexts/shloka-context`,
                    lifespanCount: 5,
                    parameters: { chapter: parseInt(chapter), verse: 1, style: style }
                });
                localStorage.setItem('gitaContext', JSON.stringify(currentContext));
                
                const shlokaText = await fetchShlokaText(chapter, 1, style);
                document.getElementById('gurudattaText').innerText = shlokaText;
                document.getElementById('sringeriText').innerText = shlokaText;
                
                const audioUrl = await fetchAudioUrl(chapter, 1);
                const audioPlayer = document.getElementById('audioPlayer');
                audioPlayer.src = audioUrl;
                try {
                    await audioPlayer.play();
                    console.log(`Playing audio: ${audioUrl}`);
                } catch (error) {
                    console.error(`Error playing audio for ${chapter}.1: ${error}`);
                    document.getElementById('gurudattaText').innerText = `Error playing audio for ${chapter}.1`;
                    document.getElementById('sringeriText').innerText = `Error playing audio for ${chapter}.1`;
                }
                
                updateTextboxVisibility();
                selectElement.selectedIndex = 0;
            }
        }

        let sessionId = localStorage.getItem('gitaSessionId');
        if (!sessionId) {
            sessionId = 'session-' + Math.random().toString(36).substr(2, 9);
            localStorage.setItem('gitaSessionId', sessionId);
        }
        let currentContext = JSON.parse(localStorage.getItem('gitaContext')) || [];

        function getSelectedStyle() {
            const style = document.querySelector('input[name="style"]:checked').value;
            console.log(`Selected style: ${style}`);
            return style;
        }

        function updateTextboxVisibility() {
            const style = getSelectedStyle();
            const gurudattaText = document.getElementById('gurudattaText');
            const sringeriText = document.getElementById('sringeriText');
            const gurudattaLabel = document.getElementById('gurudattaLabel');
            const sringeriLabel = document.getElementById('sringeriLabel');

            if (style === 'gurudatta') {
                gurudattaText.classList.add('active');
                gurudattaLabel.classList.add('active');
                sringeriText.classList.remove('active');
                sringeriLabel.classList.remove('active');
            } else {
                gurudattaText.classList.remove('active');
                gurudattaLabel.classList.remove('active');
                sringeriText.classList.add('active');
                sringeriLabel.classList.add('active');
            }
        }

        async function fetchShlokaText(chapter, verse, style) {
            const url = style === 'gurudatta' 
                ? 'https://raw.githubusercontent.com/pubsaroja/bhagavad-gita-bot/refs/heads/main/BG Telugu with Uvacha2.txt'
                : 'https://raw.githubusercontent.com/pubsaroja/bhagavad-gita-bot/refs/heads/main/BG_Sringeri.txt';
            console.log(`Fetching ${style} text for chapter ${chapter}, verse ${verse} from ${url}`);
            try {
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`HTTP error: ${response.status}`);
                }
                const text = await response.text();
                console.log(`${style} text fetched, length: ${text.length} characters`);
                
                const lines = text.split('\n');
                const key1 = `${chapter}.${verse}`;
                const key2 = `${chapter}-${verse}`;
                console.log(`Searching for key: ${key1} or ${key2}`);
                
                for (let i = 0; i < lines.length; i++) {
                    const line = lines[i].trim();
                    if (line.match(new RegExp(`^${key1}\\s+|^${key2}\\s+|^${key1}\\t|^${key2}\\t|^${key1}$|^${key2}$`))) {
                        let shlokaLines = [line.substring(line.indexOf(' ') + 1 || line.indexOf('\t') + 1 || line.length)];
                        let j = i + 1;
                        while (j < lines.length && !lines[j].match(/^\d+[.-]\d+/)) {
                            shlokaLines.push(lines[j].trim());
                            j++;
                        }
                        let shlokaText = shlokaLines.join('\n').trim();
                        console.log(`Found shloka: ${shlokaText}`);
                        return `${chapter}.${verse} ${shlokaText}`;
                    }
                }

                console.log(`No line found for ${key1} or ${key2}`);
                return `Shloka ${chapter}.${verse} not found`;
            } catch (error) {
                console.error(`Error fetching ${style} text: ${error}`);
                return `Error loading shloka ${chapter}.${verse}`;
            }
        }

        async function sendCommand(intent, params) {
            const webhookUrl = 'https://gita-voice-bot-504694669439.us-central1.run.app/webhook';
            const style = params.style || getSelectedStyle();
            const quarter = params.quarter || null;
            console.log(`Sending ${intent} with params:`, JSON.stringify(params));
            const payload = {
                session: sessionId,
                queryResult: {
                    intent: { displayName: intent },
                    parameters: params,
                    outputContexts: currentContext
                }
            };

            try {
                const response = await fetch(webhookUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                if (!response.ok) {
                    throw new Error(`HTTP error: ${response.status}`);
                }
                const data = await response.json();
                console.log(`Response for ${intent}:`, JSON.stringify(data));
                
                if (data.outputContexts && data.outputContexts.length > 0) {
                    currentContext = data.outputContexts;
                    localStorage.setItem('gitaContext', JSON.stringify(currentContext));
                }

                const context = currentContext.find(ctx => ctx.name.includes('shloka-context'));
                if (context && context.parameters && Number.isInteger(context.parameters.chapter) && Number.isInteger(context.parameters.verse)) {
                    const chapter = Math.floor(context.parameters.chapter);
                    const verse = Math.floor(context.parameters.verse);
                    console.log(`Updating for chapter ${chapter}, verse ${verse}, style ${style}, quarter ${quarter}`);
                    
                    const shlokaText = await fetchShlokaText(chapter, verse, style);
                    document.getElementById('gurudattaText').innerText = shlokaText;
                    document.getElementById('sringeriText').innerText = shlokaText;
                    
                    const audioUrl = await fetchAudioUrl(chapter, verse, quarter);
                    const audioPlayer = document.getElementById('audioPlayer');
                    audioPlayer.src = audioUrl;
                    try {
                        audioPlayer.load();
                        await audioPlayer.play();
                        console.log(`Playing audio: ${audioUrl}`);
                    } catch (error) {
                        console.error(`Error playing audio for ${chapter}.${verse}: ${error}`);
                        document.getElementById('gurudattaText').innerText = `Error playing audio for ${chapter}.${verse}: ${error.message}`;
                        document.getElementById('sringeriText').innerText = `Error playing audio for ${chapter}.${verse}: ${error.message}`;
                    }
                } else {
                    console.log(`No valid context for ${intent}`);
                    const errorText = 'Please select a Shloka first';
                    document.getElementById('gurudattaText').innerText = errorText;
                    document.getElementById('sringeriText').innerText = errorText;
                }

                updateTextboxVisibility();
            } catch (error) {
                console.error(`Error sending ${intent}: ${error}`);
                const errorText = `Error communicating with server for ${intent}`;
                document.getElementById('gurudattaText').innerText = errorText;
                document.getElementById('sringeriText').innerText = errorText;
                updateTextboxVisibility();
            }
        }

        // Ensure audio plays after user interaction
        document.addEventListener('click', () => {
            const audioPlayer = document.getElementById('audioPlayer');
            audioPlayer.muted = false;
            console.log('Audio player unmuted on user interaction');
        }, { once: true });

        updateTextboxVisibility();
    </script>
    <h2>Developed by Dr.P.Udayabhaskar</h2>
</body>
</html>
