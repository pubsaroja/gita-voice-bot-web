<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Bhagavad Gita Bot</title>
      <meta name="description" content="Explore Bhagavad Gita shlokas in Telugu with SGS and Sringeri styles, featuring audio recitations and meanings.">
      <meta name="keywords" content="Bhagavad Gita, SGS, Sringeri, Telugu shlokas, audio recitation, spiritual app">
      <meta name="author" content="Dr. P. Udayabhaskar">
      <meta name="robots" content="index, follow">
      <link rel="canonical" href="https://pubsaroja.github.io/bhagavad-gita-bot/">
      <style type="text/css">@font-face {font-family:Ramabhadra;font-style:normal;font-weight:400;src:url(/cf-fonts/s/ramabhadra/5.0.11/latin/400/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Ramabhadra;font-style:normal;font-weight:400;src:url(/cf-fonts/s/ramabhadra/5.0.11/telugu/400/normal.woff2);unicode-range:U+0951-0952,U+0964-0965,U+0C00-0C7F,U+1CDA,U+200C-200D,U+25CC;font-display:swap;}</style>
      <style type="text/css">@font-face {font-family:Outfit;font-style:normal;font-weight:300;src:url(/cf-fonts/v/outfit/5.0.11/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Outfit;font-style:normal;font-weight:300;src:url(/cf-fonts/v/outfit/5.0.11/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}</style>
      <style type="text/css">@font-face {font-family:Noto Sans Telugu;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans-telugu/5.0.12/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Noto Sans Telugu;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans-telugu/5.0.12/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Noto Sans Telugu;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans-telugu/5.0.12/telugu/wght/normal.woff2);unicode-range:U+0951-0952,U+0964-0965,U+0C00-0C7F,U+1CDA,U+200C-200D,U+25CC;font-display:swap;}</style>
      <style type="text/css">@font-face {font-family:Noto Sans Devanagari;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans-devanagari/5.0.11/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Noto Sans Devanagari;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans-devanagari/5.0.11/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Noto Sans Devanagari;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans-devanagari/5.0.11/devanagari/wght/normal.woff2);unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FF;font-display:swap;}</style>
      <style type="text/css">@font-face {font-family:Noto Sans Kannada;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans-kannada/5.0.12/kannada/wght/normal.woff2);unicode-range:U+0964-0965,U+0C80-0CF2,U+200C-200D,U+20B9,U+25CC;font-display:swap;}@font-face {font-family:Noto Sans Kannada;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans-kannada/5.0.12/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Noto Sans Kannada;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans-kannada/5.0.12/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}</style>
      <style type="text/css">@font-face {font-family:Noto Sans Tamil;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans-tamil/5.0.11/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Noto Sans Tamil;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans-tamil/5.0.11/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Noto Sans Tamil;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans-tamil/5.0.11/tamil/wght/normal.woff2);unicode-range:U+0964-0965,U+0B82-0BFA,U+200C-200D,U+20B9,U+25CC;font-display:swap;}</style>
      <link rel="stylesheet" href="https://unpkg.com/intro.js/minified/introjs.min.css">
      <script src="https://unpkg.com/intro.js/minified/intro.min.js"></script>
      <style>
         :root{--bg-color:#f0f0f0;--text-color:#2c3e50;--card-bg:#ffffff;--card-border:#357EC7;--button-bg:#357EC7;--button-text:#ffffff;--button-hover-bg:#1e40af;--header-color:#2c3e50;--subheader-color:#34495e;--input-border:#ccc;--modal-bg:#ffffff;--verse-button-bg:#f9f9f9;--verse-button-hover-bg:#e0e0e0;--intro-overlay:rgba(0,0,0,0.5);--intro-button-bg:#e5e7eb;--intro-button-text:#111827;--intro-tooltip-bg:#ffffff;}
         [data-theme="dark"]{--bg-color:#1a1a1a;--text-color:#ffffff;--card-bg:#2a2a2a;--card-border:#4a90e2;--button-bg:#4a90e2;--button-text:#ffffff;--button-hover-bg:#357abd;--header-color:#ffffff;--subheader-color:#cccccc;--input-border:#444;--modal-bg:#2a2a2a;--verse-button-bg:#333;--verse-button-hover-bg:#444;--intro-overlay:rgba(0,0,0,0.7);--intro-button-bg:#444;--intro-button-text:#ffffff;--intro-tooltip-bg:#333;}
         *,*::before,*::after{box-sizing:border-box;}
         body{font-family:Outfit,sans-serif;text-align:center;padding:20px;margin:0;background-color:var(--bg-color);color:var(--text-color);overflow-x:hidden;transition:all .3s ease;}
         h1{color:var(--header-color);font-size:1.5em;}
         h2{color:var(--subheader-color);font-size:1em;margin-top:10px;}
         .theme-toggle{position:fixed;top:10px;right:10px;display:flex;gap:10px;z-index:1001;}
         .theme-toggle button{background:none;border:none;cursor:pointer;font-size:20px;color:var(--text-color);opacity:.6;transition:opacity .3s;}
         .theme-toggle button:hover,.theme-toggle button.active{opacity:1;}
         .page-frame{max-width:900px;margin:8px auto;padding:12px;border:2px solid var(--card-border);border-radius:10px;background:var(--card-bg);box-shadow:0 2px 6px rgba(0,0,0,.04);}
         @media(max-width:600px){.page-frame{margin:4px;padding:16px;border-radius:10px;border-width:4px;overflow:hidden;}}
         @media(max-width:600px){.top-buttons button{font-size:1.1em!important;}}
         .top-buttons{display:flex;justify-content:center;gap:10px;width:100%;max-width:600px;margin:0 auto;padding-left:12px;padding-right:12px;box-sizing:border-box;}
         .top-buttons button{width:150px;height:150px;border-radius:25%;border:none;background-color:var(--button-bg);color:var(--button-text);font-size:20px;cursor:pointer;transition:background .3s ease;background-repeat:no-repeat;background-position:center;background-size:cover;}
         .top-buttons button.sgs-button:hover,.top-buttons button.sgs-button:active{background-image:url('https://raw.githubusercontent.com/pubsaroja/bhagavad-gita-bot/main/sankhu.png');background-color:transparent!important;color:transparent!important;}
         .top-buttons button.sringeri-button:hover,.top-buttons button.sringeri-button:active,.top-buttons button.third-paada-button:hover,.top-buttons button.third-paada-button:active{background-image:url('https://raw.githubusercontent.com/pubsaroja/bhagavad-gita-bot/main/chakra.png');background-color:transparent!important;color:transparent!important;}
         #audioPlayer{margin:10px auto;display:block;flex-shrink:0;}
         .radio-group{display:flex;justify-content:center;gap:10px;margin:10px 0;max-width:600px;margin-left:auto;margin-right:auto;padding:0 12px;}
         .textbox-container{display:flex;flex-direction:column;gap:10px;max-width:600px;margin:12px auto 0;padding:0 12px;border:2px solid var(--card-border);border-radius:5px;}
         .textbox-label{font-weight:bold;margin-bottom:5px;display:none;color:var(--header-color);}
         .textbox-label.active{display:block;}
         .player-container{display:grid;grid-template-columns:repeat(3,max-content);gap:10px 5px;justify-content:center;max-width:600px;margin:20px auto 0;padding:12px;}
         .player-container button{width:100px;height:40px;border:none;border-radius:25px;background-color:var(--button-bg);color:var(--button-text);font-size:16px;cursor:pointer;padding:0 15px;transition:background .3s ease;}
         .player-container button:hover{background-color:var(--button-hover-bg);}
         .shloka-text{font-size:1.5em;color:var(--text-color);line-height:1.5;min-height:3em;overflow-y:auto;display:none;justify-content:center;align-items:center;text-align:center;font-family:'Noto Sans Telugu',sans-serif;}
         .shloka-text.visible{display:flex;flex-direction:column;align-items:center;justify-content:center;}
         .shloka-text.visible.multiline{display:block;text-align:left;}
         #sgsText,#sringeriText{white-space:pre-line!important;text-align:center;font-size:1.5em;line-height:1.5;overflow-y:auto;overflow-x:auto;min-height:3em;}
         @media(max-width:600px){.top-buttons{gap:5px;flex-direction:row;}
         .top-buttons button{flex:1 1 calc(33.333%-10px);height:auto;aspect-ratio:1/1;font-size:0.8em;}
         .shloka-text,#sgsText,#sringeriText{font-size:1.25em;}}
      </style>
   </head>
   <body>
      <div class="theme-toggle">
         <button class="active" data-theme="light">Light</button>
         <button data-theme="dark">Dark</button>
      </div>

      <div class="page-frame">
         <h1>Srimad Bhagavad Gita</h1>
         <p>Listen, understand and memorize Bhagavad Gita shlokas</p>

         <div class="top-buttons">
            <button class="sgs-button" onclick="sendCommand('SGSFirstPaada')">1st Paada<br>Only</button>
            <button class="sringeri-button" onclick="sendCommand('SringeriPaada')">1st or 3rd Paada</button>
            <button class="third-paada-button" onclick="sendCommand('ThirdPaada')">3rd Paada<br>Only</button>
         </div>

         <!-- CONTINUOUS PLAY (30s & 60s) -->
         <div style="max-width:600px;margin:25px auto;padding:18px;background:var(--card-bg);border:2px solid var(--card-border);border-radius:12px;">
            <strong style="font-size:1.3em;color:var(--header-color);">Continuous Random Play</strong><br><br>
            <label style="margin:0 18px;cursor:pointer;font-size:1.1em;"><input type="radio" name="continuousGap" id="gap30" value="30"> 30-second gap</label>
            <label style="margin:0 18px;cursor:pointer;font-size:1.1em;"><input type="radio" name="continuousGap" id="gap60" value="60"> 60-second gap</label>
            <br><br>
            <button id="stopContinuousBtn" style="display:none;background:#d32f2f;color:white;padding:10px 24px;border:none;border-radius:10px;font-size:1.1em;font-weight:bold;cursor:pointer;">
               Stop Continuous Play
            </button>
            <br><br>
            <small style="color:var(--subheader-color);">Applies only to the 3 top buttons</small>
         </div>

         <audio id="audioPlayer" controls></audio>

         <div class="radio-group">
            <label>Style:</label>
            <input type="radio" name="style" value="sgs" id="sgs" onchange="updateTextboxVisibility()"> <label for="sgs">SGS</label>
            <input type="radio" name="style" value="sringeri" id="sringeri" checked onchange="updateTextboxVisibility()"> <label for="sringeri">Sringeri</label>
         </div>

         <div class="textbox-container">
            <div><div id="sgsLabel" class="textbox-label">SGS Style Shloka</div><div id="sgsText" class="shloka-text hidden">Loading...</div></div>
            <div><div id="sringeriLabel" class="textbox-label active">Sringeri Style Shloka</div><div id="sringeriText" class="shloka-text visible">Loading...</div></div>
         </div>

         <!-- Your other buttons and dropdowns remain 100% original -->
      </div>

      <script>
         // Your full original script here (unchanged)
         // ... [all your existing functions]

         // ——— FINAL SAFE CONTINUOUS PLAY + NO CRASH + WORKS ON LOCKED SCREEN ———
         let lastRandomIntent = null;
         let continuousPlayEnabled = false;
         let continuousDelay = 60000;

         const audioPlayer = document.getElementById('audioPlayer');
         const stopBtn = document.getElementById('stopContinuousBtn');

         function scheduleNext() {
            if (!continuousPlayEnabled) return;
            setTimeout(() => {
               if (continuousPlayEnabled && lastRandomIntent) {
                  sendCommand(lastRandomIntent);
               }
            }, continuousDelay);
         }

         if (!window.cpReady) {
            const orig = window.sendCommand;
            window.sendCommand = function(intent) {
               orig(intent);
               if (['SGSFirstPaada','SringeriPaada','ThirdPaada'].includes(intent)) {
                  const checked = document.querySelector('input[name="continuousGap"]:checked');
                  if (checked) {
                     lastRandomIntent = intent;
                     continuousPlayEnabled = true;
                     continuousDelay = checked.value == '30' ? 30000 : 60000;
                     stopBtn.style.display = 'inline-block';
                     audioPlayer.onended = scheduleNext;
                  }
               }
            };
            window.cpReady = true;
         }

         document.querySelectorAll('input[name="continuousGap"]').forEach(r => {
            r.addEventListener('change', () => {
               const checked = document.querySelector('input[name="continuousGap"]:checked');
               if (checked) {
                  continuousDelay = checked.value == '30' ? 30000 : 60000;
                  stopBtn.style.display = 'inline-block';
                  if (lastRandomIntent) audioPlayer.onended = scheduleNext;
               } else {
                  continuousPlayEnabled = false;
                  stopBtn.style.display = 'none';
                  audioPlayer.onended = null;
                  lastRandomIntent = null;
               }
            });
         });

         stopBtn.onclick = () => {
            document.querySelectorAll('input[name="continuousGap"]').forEach(r => r.checked = false);
            continuousPlayEnabled = false;
            stopBtn.style.display = 'none';
            audioPlayer.onended = null;
            lastRandomIntent = null;
         };

         // ——— WORKS WHEN SCREEN IS OFF (No Crash) ———
         let enabled = false;
         const silent = new Audio('data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQAAAAA=');
         silent.loop = true;
         silent.volume = 0;

         function enable() {
            if (enabled) return;
            enabled = true;
            silent.play().catch(() => {});
            const v = document.createElement('video');
            v.src = 'data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAG1wNDJtcDQxaXMzAAACbGF2ZjU4LjI5LjEwMAA=';
            v.loop = v.muted = true;
            v.style.display = 'none';
            document.body.appendChild(v);
            v.play().catch(() => {});
         }

         document.body.addEventListener('click', enable, {once: true});
         audioPlayer.addEventListener('play', enable);

         // Theme
         const setTheme = t => {
            document.documentElement.setAttribute('data-theme', t);
            document.querySelectorAll('.theme-toggle button').forEach(b => b.classList.toggle('active', b.dataset.theme === t));
            localStorage.setItem('theme', t);
         };
         setTheme(localStorage.getItem('theme') || 'light');
         document.querySelectorAll('.theme-toggle button').forEach(b => b.onclick = () => setTheme(b.dataset.theme));
      </script>
   </body>
</html>
