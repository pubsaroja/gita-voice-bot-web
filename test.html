<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Bhagavad Gita Bot</title>
      <meta name="description" content="Explore Bhagavad Gita shlokas in Telugu with SGS and Sringeri styles, featuring audio recitations and meanings.">
      <meta name="author" content="Dr. P. Udayabhaskar">
      <link rel="canonical" href="https://pubsaroja.github.io/bhagavad-gita-bot/">

      <!-- Fonts -->
      <style type="text/css">
         @font-face {font-family:Ramabhadra;font-style:normal;font-weight:400;src:url(/cf-fonts/s/ramabhadra/5.0.11/latin/400/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}
         @font-face {font-family:Ramabhadra;font-style:normal;font-weight:400;src:url(/cf-fonts/s/ramabhadra/5.0.11/telugu/400/normal.woff2);unicode-range:U+0951-0952,U+0964-0965,U+0C00-0C7F,U+1CDA,U+200C-200D,U+25CC;font-display:swap;}
         @font-face {font-family:Outfit;font-style:normal;font-weight:300;src:url(/cf-fonts/v/outfit/5.0.11/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}
         @font-face {font-family:Outfit;font-style:normal;font-weight:300;src:url(/cf-fonts/v/outfit/5.0.11/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}
         @font-face {font-family:Noto Sans Telugu;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans-telugu/5.0.12/telugu/wght/normal.woff2);unicode-range:U+0951-0952,U+0964-0965,U+0C00-0C7F,U+1CDA,U+200C-200D,U+25CC;font-display:swap;}
         @font-face {font-family:Noto Sans Devanagari;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans-devanagari/5.0.11/devanagari/wght/normal.woff2);unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FF;font-display:swap;}
         @font-face {font-family:Noto Sans Kannada;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans-kannada/5.0.12/kannada/wght/normal.woff2);unicode-range:U+0964-0965,U+0C80-0CF2,U+200C-200D,U+20B9,U+25CC;font-display:swap;}
         @font-face {font-family:Noto Sans Tamil;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans-tamil/5.0.11/tamil/wght/normal.woff2);unicode-range:U+0964-0965,U+0B82-0BFA,U+200C-200D,U+20B9,U+25CC;font-display:swap;}
      </style>

      <!-- Intro.js -->
      <link rel="stylesheet" href="https://unpkg.com/intro.js/minified/introjs.min.css">
      <script src="https://unpkg.com/intro.js/minified/intro.min.js"></script>

      <style>
         :root{--bg-color:#f0f0f0;--text-color:#2c3e50;--card-bg:#ffffff;--card-border:#357EC7;--button-bg:#357EC7;--button-text:#ffffff;--button-hover-bg:#1e40af;--header-color:#2c3e50;--subheader-color:#34495e;--input-border:#ccc;}
         [data-theme="dark"]{--bg-color:#1a1a1a;--text-color:#ffffff;--card-bg:#2a2a2a;--card-border:#4a90e2;--button-bg:#4a90e2;--button-hover-bg:#357abd;--header-color:#ffffff;--subheader-color:#cccccc;--input-border:#444;}
         *,*::before,*::after{box-sizing:border-box;}
         body{font-family:Outfit,sans-serif;text-align:center;padding:20px;margin:0;background:var(--bg-color);color:var(--text-color);transition:all .3s;}
         .page-frame{max-width:900px;margin:8px auto;padding:20px;border:2px solid var(--card-border);border-radius:10px;background:var(--card-bg);box-shadow:0 4px 12px rgba(0,0,0,.1);}
         h1{font-size:1.8em;color:var(--header-color);}
         .top-buttons{display:flex;justify-content:center;gap:20px;margin:20px auto;flex-wrap:wrap;}
         .top-buttons button{width:150px;height:150px;border-radius:25%;border:none;background:var(--button-bg);color:var(--button-text);font-size:18px;cursor:pointer;background-repeat:no-repeat;background-position:center;background-size:cover;transition:.3s;}
         .top-buttons button.sgs-button:hover,.top-buttons button.sgs-button:active{background-image:url('https://raw.githubusercontent.com/pubsaroja/bhagavad-gita-bot/main/sankhu.png');background-color:transparent!important;color:transparent!important;}
         .top-buttons button.sringeri-button:hover,.top-buttons button.sringeri-button:active,.top-buttons button.third-paada-button:hover,.top-buttons button.third-paada-button:active,.top-buttons button.auto-random-mixed:hover,.top-buttons button.auto-random-mixed:active{background-image:url('https://raw.githubusercontent.com/pubsaroja/bhagavad-gita-bot/main/chakra.png');background-color:transparent!important;color:transparent!important;}
         .player-container{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px;max-width:600px;margin:20px auto;}
         .player-container button{height:50px;border:none;border-radius:25px;background:var(--button-bg);color:var(--button-text);font-size:16px;cursor:pointer;transition:.3s;}
         .player-container button:hover{background:var(--button-hover-bg);}
         #audioPlayer{margin:15px auto;width:90%;max-width:600px;}
         .dropdown-container{display:flex;flex-direction:column;gap:15px;max-width:600px;margin:20px auto;}
         select{width:100%;padding:12px;border-radius:8px;border:1px solid var(--input-border);background:var(--card-bg);color:var(--text-color);font-size:16px;}
         .textbox-container{margin-top:20px;border:2px solid var(--card-border);border-radius:8px;padding:15px;max-width:600px;margin-left:auto;margin-right:auto;}
         #sgsText,#sringeriText{font-size:1.5em;line-height:1.6;text-align:center;min-height:100px;font-family:'Noto Sans Telugu',sans-serif;}
         .credits{font-size:0.9em;margin-top:30px;}
         @media(max-width:600px){.top-buttons button{width:120px;height:120px;font-size:16px;}}
      </style>
   </head>
   <body>
      <div class="page-frame">
         <h1>Srimad Bhagavad Gita</h1>
         <p>Listen, understand and memorize Bhagavad Gita shlokas</p>

         <!-- Top 3 Big Buttons -->
         <div class="top-buttons">
            <button class="sgs-button" onclick="sendCommand('SGSFirstPaada')">1st Paada<br>Only</button>
            <button class="sringeri-button" onclick="sendCommand('SringeriPaada')">1st or 3rd Paada</button>
            <button class="third-paada-button" onclick="sendCommand('ThirdPaada')">3rd Paada<br>Only</button>
         </div>

         <audio id="audioPlayer" controls></audio>

         <!-- Style -->
         <div style="margin:15px;">
            <label>Style: </label>
            <input type="radio" name="style" value="sgs" id="sgs" onchange="updateTextboxVisibility()"> <label for="sgs">SGS</label>
            <input type="radio" name="style" value="sringeri" id="sringeri" checked onchange="updateTextboxVisibility()"> <label for="sringeri">Sringeri</label>
         </div>

         <!-- Navigation -->
         <div class="player-container">
            <button onclick="sendCommand('PreviousShloka')">Previous</button>
            <button onclick="sendCommand('FullShloka')">Full</button>
            <button onclick="sendCommand('NextFullShloka')">Next</button>
         </div>

         <!-- Main Functions -->
         <div class="player-container">
            <button id="meaningsButton" onclick="handleMeanings()">Meanings</button>
            <button onclick="showVerseTable()">Selector</button>
            <button onclick="toggleInstructions()">Help</button>
            <button onclick="window.open('https://pubsaroja.github.io/gita-voice-bot-web/GroupedShlokas.html','_blank')">Grouped</button>
            <button onclick="showConfusing()">Confusing</button>
            <button onclick="showUvacha()">Uvacha</button>
         </div>

         <!-- NEW: Auto Random Buttons (same style) -->
         <div class="player-container" style="margin-top:25px;">
            <button onclick="startAutoRandom('sgs')">Auto Random<br><small>SGS</small></button>
            <button onclick="startAutoRandom('sringeri')">Auto Random<br><small>Sringeri</small></button>
            <button class="auto-random-mixed" onclick="startAutoRandom('mixed')">Auto Random<br><small>Mixed</small></button>
         </div>

         <!-- Dropdowns -->
         <div class="dropdown-container">
            <div>
               <label>Random Shloka Chapterwise:</label>
               <select id="chapterSelect" onchange="handleChapterSelect(this)">
                  <option value="" selected disabled>Select Chapter</option>
                  <option value="1">1. అర్జునవిషాదయోగః</option><option value="2">2. సాఙ్ఖ్యయోగః</option><option value="3">3. కర్మయోగః</option><option value="4">4. జ్ఞానయోగః</option><option value="5">5. కర్మసన్న్యాసయోగః</option>
                  <option value="6">6. ఆత్మసంయమయోగః</option><option value="7">7. జ్ఞానవిజ్ఞానయోగః</option><option value="8">8. అక్షరపరబ్రహ్మయోగః</option><option value="9">9. రాజవిద్యారాజగుహ్యయోగః</option><option value="10">10. విభూతియోగః</option>
                  <option value="11">11. విశ్వరూపసన్దర్శనయోగః</option><option value="12">12. భక్తియోగః</option><option value="13">13. క్షేత్రక్షేత్రజ్ఞవిభాగయోగః</option><option value="14">14. గుణత్రయవిభాగయోగః</option><option value="15">15. పురుషోత్తమప్రాప్తియోగః</option>
                  <option value="16">16. దైవాసురసమ్పద్విభాగయోగః</option><option value="17">17. శ్రద్ధాత్రయవిభాగయోగః</option><option value="18">18. మోక్షసన్న్యాసయోగః</option>
               </select>
            </div>
            <div>
               <label>Continuous Play:</label>
               <select id="continuousPlaySelect" onchange="handleContinuousPlay(this)">
                  <option value="" selected disabled>Select Chapter</option>
                  <option value="1">1. అర్జునవిషాదయోగః</option><option value="2">2. సాఙ్ఖ్యయోగః</option><option value="3">3. కర్మయోగః</option><option value="4">4. జ్ఞానయోగః</option><option value="5">5. కర్మసన్న్యాసయోగః</option>
                  <option value="6">6. ఆత్మసంయమయోగః</option><option value="7">7. జ్ఞానవిజ్ఞానయోగః</option><option value="8">8. అక్షరపరబ్రహ్మయోగః</option><option value="9">9. రాజవిద్యారాజగుహ్యయోగః</option><option value="10">10. విభూతియోగః</option>
                  <option value="11">11. విశ్వరూపదర్శనయోగః</option><option value="12">12. భక్తియోగః</option><option value="13">13. క్షేత్రక్షేత్రజ్ఞవిభాగయోగః</option><option value="14">14. గుణత్రయవిభాగయోగః</option><option value="15">15. పురుషోత్తమప్రాప్తియోగః</option>
                  <option value="16">16. దైవాసురసమ్పద్విభాగయోగః</option><option value="17">17. శ్రద్ధాత్రయవిభాగయోగః</option><option value="18">18. మోక్షసన్న్యాసయోగః</option>
               </select>
            </div>
         </div>

         <div style="margin:20px;">
            <h3>Search (Telugu/English/Number):</h3>
            <input type="text" id="search-input" placeholder="Enter word or number" style="width:70%;padding:10px;font-size:16px;">
            <button id="search-button" style="padding:10px 20px;">Search</button>
         </div>

         <div class="textbox-container">
            <div id="sgsLabel" style="font-weight:bold;display:none;">SGS Style Shloka</div>
            <div id="sgsText" class="shloka-text hidden">Your Shloka will appear here.</div>
            <div id="sringeriLabel" style="font-weight:bold;">Sringeri Style Shloka</div>
            <div id="sringeriText" class="shloka-text visible">Your Shloka will appear here.</div>
         </div>

         <div class="credits">
            SGS Audio: Pujya Sri Datta Vijayanand Teertha Swamiji<br>
            Sringeri Audio courtesy: Smt Mathangi Kailasnath<br>
            Developed by Dr. P. Udayabhaskar
         </div>
      </div>

      <script>
         const baseUrl = 'https://raw.githubusercontent.com/pubsaroja/bhagavad-gita-bot/main';
         const verseCounts = {1:47,2:72,3:43,4:42,5:29,6:47,7:30,8:28,9:34,10:42,11:55,12:20,13:35,14:27,15:20,16:24,17:28,18:78};
         let currentContext = [];
         let sessionId = 'session-' + Math.random().toString(36).substr(2,9);
         let autoRandomTimer = null;
         let autoRandomStyle = null;

         // === AUTO RANDOM FEATURE ===
         function stopAutoRandom() {
             if (autoRandomTimer) clearTimeout(autoRandomTimer);
             autoRandomTimer = null; autoRandomStyle = null;
             document.querySelectorAll('.player-container button').forEach(b => {
                 if (b.onclick.toString().includes('startAutoRandom')) {
                     b.style.backgroundImage = ''; b.style.backgroundColor = ''; b.style.color = '';
                 }
             });
         }

         async function playRandomFullShloka() {
             const style = autoRandomStyle === 'mixed' ? (Math.random()<0.5?'sgs':'sringeri') : autoRandomStyle;
             document.querySelector(`input[value="${style}"]`).checked = true;
             updateTextboxVisibility();

             const chapter = Math.floor(Math.random()*18)+1;
             const verse = Math.floor(Math.random()*verseCounts[chapter])+1;

             currentContext = [{name:`projects/gita-voice-bot/agent/sessions/${sessionId}/contexts/shloka-context`,lifespanCount:5,parameters:{chapter,verse,style}}];
             localStorage.setItem('gitaContext', JSON.stringify(currentContext));

             const sgs = await fetchCombinedShlokaText(chapter, verse, 'sgs');
             const sri = await fetchCombinedShlokaText(chapter, verse, 'sringeri');
             document.getElementById('sgsText').innerText = sgs;
             document.getElementById('sringeriText').innerText = sri;
             adjustTextboxHeight(); updateTextboxVisibility();

             const folder = style === 'sringeri' ? 'AudioFullSringeri' : 'AudioFullSGS';
             const audio = document.getElementById('audioPlayer');
             audio.src = `${baseUrl}/${folder}/${chapter}.${verse}.mp3`;
             audio.load(); await audio.play().catch(()=>{});
         }

         function startAutoRandom(style) {
             stopAutoRandom(); autoRandomStyle = style;
             const btn = event.target;
             btn.style.backgroundImage = style==='sgs' ? 'url("https://raw.githubusercontent.com/pubsaroja/bhagavad-gita-bot/main/sankhu.png")' : 'url("https://raw.githubusercontent.com/pubsaroja/bhagavad-gita-bot/main/chakra.png")';
             btn.style.backgroundColor = 'transparent'; btn.style.color = 'transparent';

             async function loop() {
                 await playRandomFullShloka();
                 const audio = document.getElementById('audioPlayer');
                 await new Promise(r => { audio.onended = r; setTimeout(r,90000); });
                 await new Promise(r => setTimeout(r,60000)); // 60s pause
                 if (autoRandomTimer) loop();
             }
             loop();
         }

         // Stop on any other interaction
         document.querySelectorAll('button, input, select').forEach(el => {
             if (!el.onclick || !el.onclick.toString().includes('startAutoRandom')) {
                 el.addEventListener('click', stopAutoRandom);
                 el.addEventListener('change', stopAutoRandom);
             }
         });

         // === YOUR ORIGINAL FUNCTIONS (keep everything else you had) ===
         // Paste all your existing functions here: fetchCombinedShlokaText, sendCommand, handleChapterSelect, etc.
         // (They remain 100% unchanged and fully functional)

         // Example placeholder for one key function:
         async function fetchCombinedShlokaText(ch, v, st) {
             // Your original implementation here
             return `${ch}.${v} (Sample text in ${st.toUpperCase()} style)`;
         }

         function updateTextboxVisibility() {
             const isSGS = document.getElementById('sgs').checked;
             document.getElementById('sgsText').style.display = isSGS ? 'block' : 'none';
             document.getElementById('sringeriText').style.display = isSGS ? 'none' : 'block';
             document.getElementById('sgsLabel').style.display = isSGS ? 'block' : 'none';
             document.getElementById('sringeriLabel').style.display = isSGS ? 'none' : 'block';
         }

         function adjustTextboxHeight() {
             ['sgsText','sringeriText'].forEach(id => {
                 const el = document.getElementById(id);
                 el.style.height = 'auto';
                 el.style.height = el.scrollHeight + 'px';
             });
         }

         // Initialize
         updateTextboxVisibility();
      </script>
   </body>
</html>
